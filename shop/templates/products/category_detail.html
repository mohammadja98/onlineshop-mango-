{% extends "_base.html" %}

{% load i18n %}
{% load static %}
{% load humanize %}
{% load persian_translation_tags %}

{% block page_title %}{{ category.name }} {% endblock %}

{% block content %}

<!-- ðŸŸ¢ Top Header (Breadcrumb) -->
<div class="bg-gradient-to-r from-yellow-100 via-yellow-50 to-green-100 py-10 mb-10 border-b">
  <div class="container mx-auto text-right px-4">
    <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-2">
      {{ category.name }}
    </h1>
    <p class="text-gray-600 text-sm">
      {% trans "Browse products in this category" %}
    </p>
  </div>
</div>

<!-- ðŸŸ¡ Products Grid -->
<div class="container mx-auto px-4">
  {% if products %}
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8">
      {% for product in products %}
        <div class="bg-white rounded-2xl shadow hover:shadow-xl overflow-hidden transition transform hover:-translate-y-1">
          
          <!-- product image-->
          <a href="{{ product.get_absolute_url }}" class="block relative">
            {% if product.image %}
              <img src="{{ product.image.url }}" alt="{{ product.name }}"
                   class="w-full h-48 object-contain p-4 bg-white">
            {% else %}
              <div class="w-full h-48 flex items-center justify-center bg-yellow-50 text-yellow-600 font-bold text-2xl">
                {{ product.name|first }}
              </div>
            {% endif %}
            {% if product.available %}
              <span class="absolute top-2 right-2 bg-green-600 text-white text-xs px-2 py-1 rounded-lg">
                {% trans "exist" %}
              </span>
            {% else %}
              <span class="absolute top-2 right-2 bg-red-600 text-white text-xs px-2 py-1 rounded-lg">
                {% trans "non-existent" %}
              </span>
            {% endif %}
          </a>

          <!-- product info -->
          <div class="p-4 text-right">
            <h3 class="font-semibold text-gray-800 mb-2 truncate">
              <a href="{{ product.get_absolute_url }}" class="hover:text-green-600">
                {{ product.name }}
              </a>
            </h3>
            <p class="text-yellow-700 font-bold mb-3">
              {{ product.price|intcomma:False|translate_number }} {% trans "$" %}

            </p>

            <!-- add to cart btn-->
            <form method="post" action="{% url 'cart:cart_add' product.id %}">
              {% csrf_token %}
              <input type="hidden" name="quantity" value="1">
              <button type="submit"
                      class="w-full bg-gradient-to-r from-yellow-400 to-yellow-600 text-white py-2 rounded-lg font-medium hover:from-yellow-500 hover:to-yellow-700 transition"
                      {% if not product.available %}disabled{% endif %}>
                {% trans "add to cart" %}
              </button>
            </form>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center py-20">
      <h3 class="text-gray-500 text-lg">{% trans "No products were found in this category." %}</h3>
    </div>
  {% endif %}
</div>

{% endblock %}
